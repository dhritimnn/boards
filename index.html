<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Track your 20-day board exam preparation">
  <meta name="theme-color" content="#4f46e5">
  <title>Board Exam Study Tracker</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- iOS Support -->
  <link rel="apple-touch-icon" href="/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Study Tracker">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    // Simple icon components using SVG
    const BookOpen = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      </svg>
    );
    
    const CheckCircle = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );
    
    const Circle = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
      </svg>
    );
    
    const Edit2 = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
      </svg>
    );
    
    const Star = ({ size = 24, className = "", fill = "none" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
      </svg>
    );
    
    const Calendar = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
    );
    
    const Clock = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    );
    
    const BookMarked = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
        <path d="M10 2v8l3-3 3 3V2"></path>
      </svg>
    );
    
    const Sparkles = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path>
        <path d="M5 3v4"></path>
        <path d="M19 17v4"></path>
        <path d="M3 5h4"></path>
        <path d="M17 19h4"></path>
      </svg>
    );

    function StudyTracker() {
      // PWA Installation
      useEffect(() => {
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/service-worker.js').catch(() => {});
        }
      }, []);

      const START_DATE = '2026-01-03';
      
      const allSubjects = [
        { name: 'Assamese', priority: true },
        { name: 'English', priority: false },
        { name: 'Maths', priority: false },
        { name: 'Elective', priority: false },
        { name: 'Science', priority: false },
        { name: 'Social Studies', priority: true }
      ];

      const motivationalQuotes = [
        "Success is the sum of small efforts repeated day in and day out. Keep going! ðŸŒŸ",
        "Today's accomplishments were tomorrow's impossibilities. Well done! ðŸ’ª",
        "You're one day closer to your goal. Stay focused! ðŸŽ¯",
        "Every day is a new opportunity to get better. Great work today! âœ¨",
        "Consistency is key. You showed up today - that's what matters! ðŸ”¥",
        "Small progress is still progress. Be proud of yourself! ðŸŒ±",
        "Your future self will thank you for the work you did today! ðŸš€",
        "Education is the passport to the future. Keep stamping it! ðŸ“š",
        "The expert in anything was once a beginner. You're getting there! ðŸ’«",
        "Believe in yourself and all that you are. Tomorrow is another chance! ðŸŒˆ"
      ];

      const getCurrentDay = () => {
        const start = new Date(START_DATE);
        const today = new Date();
        const diffTime = today - start;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        return Math.min(Math.max(diffDays + 1, 1), 20);
      };

      const getCurrentDate = () => {
        return new Date().toISOString().split('T')[0];
      };

      const [currentDay, setCurrentDay] = useState(getCurrentDay());
      const [lastVisitDate, setLastVisitDate] = useState(() => {
        return localStorage.getItem('lastVisitDate') || '';
      });
      const [showSelectionPopup, setShowSelectionPopup] = useState(false);
      const [showEndDayPopup, setShowEndDayPopup] = useState(false);
      const [showQuotePopup, setShowQuotePopup] = useState(false);
      const [showReflectionsPopup, setShowReflectionsPopup] = useState(false);
      const [selectedSubjects, setSelectedSubjects] = useState([]);
      const [tempSelection, setTempSelection] = useState([]);
      const [tasks, setTasks] = useState([]);
      const [reflectionText, setReflectionText] = useState('');
      const [currentQuote, setCurrentQuote] = useState('');
      const [reflections, setReflections] = useState(() => {
        const saved = localStorage.getItem('reflections');
        return saved ? JSON.parse(saved) : [];
      });

      useEffect(() => {
        const today = getCurrentDate();
        if (today !== lastVisitDate) {
          setLastVisitDate(today);
          localStorage.setItem('lastVisitDate', today);
          setShowSelectionPopup(true);
          setSelectedSubjects([]);
          setTasks([]);
          setCurrentDay(getCurrentDay());
        }
      }, [lastVisitDate]);

      const toggleTempSelection = (subjectName) => {
        setTempSelection(prev => 
          prev.includes(subjectName)
            ? prev.filter(s => s !== subjectName)
            : [...prev, subjectName]
        );
      };

      const completeSelection = () => {
        if (tempSelection.length === 0) return;
        
        setSelectedSubjects(tempSelection);
        setTasks(tempSelection.map(name => ({
          subject: allSubjects.find(s => s.name === name),
          completed: false,
          notes: ''
        })));
        setShowSelectionPopup(false);
        setTempSelection([]);
      };

      const openEditSelection = () => {
        setTempSelection(selectedSubjects);
        setShowSelectionPopup(true);
      };

      const toggleTask = (subjectName) => {
        setTasks(prev => prev.map(t => 
          t.subject.name === subjectName 
            ? { ...t, completed: !t.completed }
            : t
        ));
      };

      const updateNotes = (subjectName, notes) => {
        setTasks(prev => prev.map(t => 
          t.subject.name === subjectName 
            ? { ...t, notes }
            : t
        ));
      };

      const handleEndDay = () => {
        setShowEndDayPopup(true);
      };

      const submitReflection = () => {
        if (!reflectionText.trim()) return;

        const newReflection = {
          day: currentDay,
          date: getCurrentDate(),
          reflection: reflectionText,
          subjects: tasks.map(t => ({
            name: t.subject.name,
            completed: t.completed,
            notes: t.notes
          }))
        };

        const updatedReflections = [...reflections, newReflection];
        setReflections(updatedReflections);
        localStorage.setItem('reflections', JSON.stringify(updatedReflections));

        const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
        setCurrentQuote(randomQuote);
        setShowEndDayPopup(false);
        setShowQuotePopup(true);
        setReflectionText('');
      };

      const closeQuoteAndReset = () => {
        setShowQuotePopup(false);
        const newDate = getCurrentDate();
        const tomorrow = new Date(newDate);
        tomorrow.setDate(tomorrow.getDate() + 1);
        const tomorrowStr = tomorrow.toISOString().split('T')[0];
        
        setLastVisitDate(tomorrowStr);
        localStorage.setItem('lastVisitDate', tomorrowStr);
        setSelectedSubjects([]);
        setTasks([]);
        setCurrentDay(prev => Math.min(prev + 1, 20));
        setShowSelectionPopup(true);
      };

      const formatDate = (dateStr) => {
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-US', { 
          weekday: 'long',
          month: 'long', 
          day: 'numeric', 
          year: 'numeric' 
        });
      };

      const formatShortDate = (dateStr) => {
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric', 
          year: 'numeric' 
        });
      };

      const completedCount = tasks.filter(t => t.completed).length;
      const totalCount = tasks.length;

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
          {showSelectionPopup && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg shadow-2xl max-w-md w-full p-6">
                <h2 className="text-2xl font-bold text-gray-800 mb-2">Select Today's Subjects</h2>
                <p className="text-sm text-gray-600 mb-6">Choose which subjects you'll study today</p>
                
                <div className="space-y-3 mb-6">
                  {allSubjects.map(subject => (
                    <button
                      key={subject.name}
                      onClick={() => toggleTempSelection(subject.name)}
                      className={`w-full p-4 rounded-lg border-2 transition-all flex items-center justify-between ${
                        tempSelection.includes(subject.name)
                          ? 'border-indigo-500 bg-indigo-50'
                          : 'border-gray-200 hover:border-indigo-300'
                      }`}
                    >
                      <div className="flex items-center gap-3">
                        {tempSelection.includes(subject.name) ? (
                          <CheckCircle size={24} className="text-indigo-600" />
                        ) : (
                          <Circle size={24} className="text-gray-400" />
                        )}
                        <span className="font-medium text-gray-800">{subject.name}</span>
                      </div>
                      {subject.priority && (
                        <Star size={18} className="text-yellow-500" fill="currentColor" />
                      )}
                    </button>
                  ))}
                </div>

                <button
                  onClick={completeSelection}
                  disabled={tempSelection.length === 0}
                  className={`w-full py-3 rounded-lg font-semibold transition-all ${
                    tempSelection.length === 0
                      ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                      : 'bg-indigo-600 text-white hover:bg-indigo-700'
                  }`}
                >
                  Complete Selection ({tempSelection.length} subjects)
                </button>
              </div>
            </div>
          )}

          {showEndDayPopup && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg shadow-2xl max-w-lg w-full p-6">
                <h2 className="text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2">
                  <BookMarked size={28} className="text-indigo-600" />
                  How Did Today Go?
                </h2>
                <p className="text-sm text-gray-600 mb-6">Reflect on your day before moving forward</p>
                
                <textarea
                  value={reflectionText}
                  onChange={(e) => setReflectionText(e.target.value)}
                  placeholder="Write about your day... What went well? What was challenging? How do you feel about your progress?"
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"
                  rows="6"
                />

                <div className="flex gap-3 mt-6">
                  <button
                    onClick={() => setShowEndDayPopup(false)}
                    className="flex-1 py-3 rounded-lg font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 transition-all"
                  >
                    Cancel
                  </button>
                  <button
                    onClick={submitReflection}
                    disabled={!reflectionText.trim()}
                    className={`flex-1 py-3 rounded-lg font-semibold transition-all ${
                      !reflectionText.trim()
                        ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        : 'bg-indigo-600 text-white hover:bg-indigo-700'
                    }`}
                  >
                    Submit & End Day
                  </button>
                </div>
              </div>
            </div>
          )}

          {showQuotePopup && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg shadow-2xl max-w-md w-full p-8 text-center">
                <Sparkles size={48} className="text-yellow-500 mx-auto mb-4" />
                <p className="text-xl text-gray-800 mb-6 leading-relaxed italic">
                  "{currentQuote}"
                </p>
                <button
                  onClick={closeQuoteAndReset}
                  className="px-6 py-3 rounded-lg font-semibold bg-indigo-600 text-white hover:bg-indigo-700 transition-all"
                >
                  Start Next Day
                </button>
              </div>
            </div>
          )}

          {showReflectionsPopup && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
              <div className="bg-white rounded-lg shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-hidden flex flex-col">
                <div className="p-6 border-b">
                  <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                    <BookMarked size={28} className="text-indigo-600" />
                    Past Reflections
                  </h2>
                </div>
                
                <div className="flex-1 overflow-y-auto p-6">
                  {reflections.length === 0 ? (
                    <div className="text-center py-12 text-gray-400">
                      <BookMarked size={64} className="mx-auto mb-4 opacity-50" />
                      <p className="text-lg">No reflections yet</p>
                      <p className="text-sm">Complete your first day to see reflections here</p>
                    </div>
                  ) : (
                    <div className="space-y-6">
                      {[...reflections].reverse().map((ref, idx) => (
                        <div key={idx} className="bg-gray-50 rounded-lg p-5 border-l-4 border-indigo-500">
                          <div className="flex items-center justify-between mb-3">
                            <div>
                              <h3 className="font-bold text-lg text-gray-800">Day {ref.day}</h3>
                              <p className="text-sm text-gray-600">{formatShortDate(ref.date)}</p>
                            </div>
                          </div>
                          
                          <div className="mb-3">
                            <p className="text-sm font-semibold text-gray-700 mb-2">Subjects Studied:</p>
                            <div className="flex flex-wrap gap-2">
                              {ref.subjects.map(subj => (
                                <span
                                  key={subj.name}
                                  className={`px-3 py-1 rounded-full text-xs font-medium ${
                                    subj.completed
                                      ? 'bg-green-100 text-green-700'
                                      : 'bg-gray-200 text-gray-600'
                                  }`}
                                >
                                  {subj.name} {subj.completed && 'âœ“'}
                                </span>
                              ))}
                            </div>
                          </div>
                          
                          <div>
                            <p className="text-sm font-semibold text-gray-700 mb-2">Reflection:</p>
                            <p className="text-gray-700 whitespace-pre-wrap">{ref.reflection}</p>
                          </div>
                          
                          {ref.subjects.some(s => s.notes) && (
                            <div className="mt-3 pt-3 border-t">
                              <p className="text-sm font-semibold text-gray-700 mb-2">Study Notes:</p>
                              <div className="space-y-1">
                                {ref.subjects.filter(s => s.notes).map(subj => (
                                  <p key={subj.name} className="text-sm text-gray-600">
                                    <span className="font-medium">{subj.name}:</span> {subj.notes}
                                  </p>
    </div>
                  ))}
                </div>
              </div>
                
              <div className="p-6 border-t">
                <button
                  onClick={() => setShowReflectionsPopup(false)}
                  className="w-full py-3 rounded-lg font-semibold bg-indigo-600 text-white hover:bg-indigo-700 transition-all"
                >
                  Close
                </button>
              </div>
            </div>
          )}

          {/* Main App UI goes here... */}
          
        </div>
      );
    }

    // Render the app
    ReactDOM.render(<StudyTracker />, document.getElementById('root'));
  </script>
</body>
</html>